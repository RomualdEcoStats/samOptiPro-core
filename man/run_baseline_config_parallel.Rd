% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/runners.R
\name{run_baseline_config_parallel}
\alias{run_baseline_config_parallel}
\title{Run a baseline NIMBLE MCMC configuration in parallel (timing = runMCMC only)}
\usage{
run_baseline_config_parallel(
  build_fn,
  niter,
  nburnin,
  thin,
  monitors = NULL,
  nchains = 3L,
  seed = 1L,
  n_cores = nchains,
  extra_export = character(0),
  samplesAsCodaMCMC = FALSE,
  export_global = FALSE,
  opts = NULL
)
}
\arguments{
\item{build_fn}{Function that builds per-chain model objects (see Builder contract).}

\item{niter}{Integer, total MCMC iterations.}

\item{nburnin}{Integer, burn-in iterations.}

\item{thin}{Integer, thinning interval.}

\item{monitors}{Optional character vector of additional monitors to add.}

\item{nchains}{Integer, number of chains to run.}

\item{seed}{Integer, base seed; chain \code{k} uses \code{seed + k - 1}.}

\item{n_cores}{Integer, number of PSOCK workers (defaults to \code{nchains}).}

\item{extra_export}{Character vector of additional objects to export to workers.}

\item{samplesAsCodaMCMC}{Logical; if TRUE, \code{runMCMC()} returns coda objects.}

\item{export_global}{Logical; if TRUE export full \code{.GlobalEnv} (use with care).}

\item{opts}{Optional samOptiPro options object (reserved for future use).}
}
\value{
A list with:
\itemize{
\item \code{samples}          : list of samples (one element per chain; type depends on \code{samplesAsCodaMCMC})
\item \code{runtime_s}        : global wall time (seconds) for the parallel \code{runMCMC()} phase only
\item \code{runtime_by_chain} : per-chain wall time (seconds) for \code{runMCMC()} only
}
}
\description{
Runs multiple MCMC chains on a PSOCK cluster using a \emph{baseline} NIMBLE
configuration. The reported runtime follows the historic semantics used in
samOptiPro: \strong{\code{runtime_s} measures only the wall-clock time spent inside
\code{nimble::runMCMC()} across all chains}, excluding model building, MCMC setup,
and compilation.
}
\details{
Implementation notes:
\itemize{
\item Each worker calls \code{build_fn()} to build (and possibly compile) the model and
MCMC configuration \strong{outside} the timed section.
\item Each worker then builds + compiles the MCMC and runs \code{nimble::runMCMC()}; only
the \code{runMCMC()} call is timed per chain.
\item The master records a global wall-clock time around the parallel \code{runMCMC()}
phase (start just before \code{parLapply()}, stop after all chains return).
}

Builder contract:
\itemize{
\item \code{build_fn()} must work as either \code{build_fn()} or
\verb{build_fn(chain_id = <int>, export_global = <logical>)}.
\item It must return a list containing at least:
\itemize{
\item \code{model}  : an uncompiled \code{nimbleModel} (recommended; used for diagnostics)
\item \code{cmodel} : the compiled model (\code{compileNimble(model)})
\item \code{conf}   : an MCMC configuration (e.g. from \code{nimble::configureMCMC()})
Optionally it may include \code{monitors}.
}
}
}
