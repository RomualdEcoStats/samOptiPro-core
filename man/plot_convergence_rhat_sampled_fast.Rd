% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plots.R
\name{plot_convergence_rhat_sampled_fast}
\alias{plot_convergence_rhat_sampled_fast}
\title{Fast convergence plots for R-hat (samplers-only), thresholded}
\usage{
plot_convergence_rhat_sampled_fast(
  diag_tbl,
  threshold = 1.01,
  sampled_only = TRUE,
  conf.mcmc = NULL,
  samples_ml = NULL,
  out_dir = NULL,
  top_k = 20L,
  prefer_split = TRUE
)
}
\arguments{
\item{diag_tbl}{A \code{data.frame} with at least column \code{target} and one of
\code{Rhat_split} or \code{Rhat_classic} having finite values.}

\item{threshold}{Numeric; R-hat reference line (default \code{1.01}).}

\item{sampled_only}{Logical (default \code{TRUE}). When \code{TRUE}, keep \strong{only} nodes
that are targets of configured samplers and also present in \code{samples_ml}.
Raises an error if none remain (strict behavior).}

\item{conf.mcmc}{Nimble MCMC configuration (required when \code{sampled_only=TRUE}).}

\item{samples_ml}{A \code{coda::mcmc.list} providing column names to intersect with sampler targets.}

\item{out_dir}{Optional output directory. Saves:
\code{Rhat_median_by_family__samplers_only_thr_*.png},
\code{TopK_worst_Rhat__samplers_only_thr_*.png},
and two CSV summaries.}

\item{top_k}{Integer; number of worst nodes by R-hat to display (default \code{20L}).}

\item{prefer_split}{Logical; if \code{TRUE} (default), use \code{Rhat_split} when available/finite,
otherwise fallback to \code{Rhat_classic}.}
}
\value{
(invisible) A list with ggplot objects and tables:
\code{list(p_family, p_top, table_family, table_top, threshold)}.
}
\description{
Builds \strong{samplers-only} convergence diagnostics based on \eqn{\hat{R}} with:
\enumerate{
\item median \eqn{\hat{R}} by family (bar chart with threshold line), and
\item top-k worst nodes by \eqn{\hat{R}} (bar chart with threshold line).
configurable threshold (default 1.01). Prefers \code{Rhat_split} if available,
falls back to \code{Rhat_classic} otherwise. Produces:
\item median R-hat by family (bar chart with threshold line), and
\item top-k worst nodes by R-hat (bar chart with threshold line).
}
}
\examples{
\dontrun{
conf <- nimble::configureMCMC(m)
rhat_res <- plot_convergence_rhat_sampled_fast(
  diag_tbl     = diag_tbl,
  threshold    = 1.01,
  sampled_only = TRUE,
  conf.mcmc    = conf,
  samples_ml   = samples_mla,
  out_dir      = "outputs/diagnostics_fast_rhat",
  top_k        = 20L,
  prefer_split = TRUE
)
}
}
